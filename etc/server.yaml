
# Plugins to load, the order of these is important
plugins:
  - build/log.plugin
  - build/httpserver.plugin
  - build/basicauth.plugin
  - build/ldapauth.plugin
  - build/sqlite.plugin
  - build/eventbus.plugin
  - build/static.plugin
  - build/template.plugin
  - build/mdns.plugin

# HTTP Server parameters
httpserver:
  addr: :80

# Handlers for serving plugins  
handlers:
  basicauth:
    prefix: /api/basicauth
    middleware:
      - log
      - basicauth
  static:
    prefix: /
    middleware:
      - log
  sqlite:
    prefix: /api/sqlite
    middleware:
      - log
      - basicauth
  mdns:
    prefix: /api/mdns
    middleware:
      - log
      - basicauth

# Basic Authentication
basicauth:
  # Realm to report to client when rejecting authentication
  realm: "go-server"
  # Path to the user/password file
  path: etc/htpasswd
  # Admin users who can create, modify and delete users through the API
  admin: root

# LDAP Authentication
ldapauth:
  url: ldaps://ldap.jumpcloud.com/
  user: uid=ldap,ou=Users,o=6041efbd63eb9010498c060a,dc=jumpcloud,dc=com
  password: "${LDAP_PASSWORD}"
  basedn: ou=Users,o=6041efbd63eb9010498c060a,dc=jumpcloud,dc=com
  filter: (uid=${user})
  expiry: 12h
  attrs:
    - cn
    - sn 
    - givenName
    - displayName
    - title
    - uid
    - mail
    - uidNumber
    - gidNumber

# Where to serve static files from
static:
  path: npm/mdns/dist

# Databases to load
sqlite:
  databases:
    test: /tmp/test.sqlite
    eventbus: ":memory:"

# Event bus
eventbus:
  # Which sqlite database to use
  database: eventbus
  # How long to retain events in database
  retain: 1h

# Render templates from path
template:
  path: .
  templates: etc/templates
  default: default.tmpl

# home network service discovery services
mdns:
  # Services are defined from the following databases
  services:
    - https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml
    - etc/service-names-port-numbers.xml
