
# Plugins to load, the order of these is important
plugins:
  - build/log.plugin
  - build/httpserver.plugin
  - build/basicauth.plugin
  - build/ldapauth.plugin
#  - build/sqlite.plugin
#  - build/eventqueue.plugin
#  - build/static.plugin
  - build/media.plugin
  - build/template.plugin
  - build/mdns.plugin
  - build/chromecast.plugin
#  - build/indexer.plugin
  - build/text-renderer.plugin
  - build/dir-renderer.plugin

# HTTP Server parameters
httpserver:
  addr: :80

# Handlers for serving plugins  
handlers:
  template:
    prefix: /
    middleware:
      - log
  basicauth:
    prefix: /api/basicauth
    middleware:
      - log
      - basicauth
#  static:
#    prefix: /api/static
#    middleware:
#      - log
#  sqlite:
#    prefix: /api/sqlite
#    middleware:
#      - log
  mdns:
    prefix: /api/mdns
    middleware:
      - log
#  indexer:
#    prefix: /api/indexer
#    middleware:
#      - log
      
# Basic Authentication
basicauth:
  # Realm to report to client when rejecting authentication
  realm: "go-server"
  # Path to the user/password file
  path: etc/htpasswd
  # Admin users who can create, modify and delete users through the API
  admin: root

# LDAP Authentication
ldapauth:
  url: ldaps://ldap.jumpcloud.com/
  user: uid=ldap,ou=Users,o=6041efbd63eb9010498c060a,dc=jumpcloud,dc=com
  password: "${LDAP_PASSWORD}"
  basedn: ou=Users,o=6041efbd63eb9010498c060a,dc=jumpcloud,dc=com
  filter: (uid=${user})
  expiry: 12h
  attrs:
    - cn
    - sn 
    - givenName
    - displayName
    - title
    - uid
    - mail
    - uidNumber
    - gidNumber

# Where to serve static files from
static:
  "/": 
    name: mDNS
    path: npm/mdns/dist
  "/sqlite": 
    name: sqlite
    path: npm/sqlite/dist

#  "/basicauth": npm/sqlite/dist
#  "/eventqueue": npm/sqlite/dist
#  "/ldapauth": npm/sqlite/dist
#  "/log": npm/sqlite/dist
#  "/chromecast": npm/sqlite/dist

sqlite:
  # Databases to load and/or create
  databases:
    main: ":memory:"

# Event queue
eventqueue:
  # Which sqlite database to use
  database: queue
  # How long to retain events in database
  retain: 1h

# Render templates from path
template:
  path: .
  templates: etc/templates
  default: default.tmpl
  # Enumerate plugins which can render content
  renderers:
    - text-renderer
    - dir-renderer

# local network service discovery
mdns:
  # Services are defined from the following databases
  services:
    - https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml
    - etc/service-names-port-numbers.xml

# File indexer
indexer:
  name: home
  database: indexer
  path: /Users/djt
  exclude: 
    # When files start with / they are path prefixes to exclude
    - /Library
    # When files start with . they are file extensions to exclude
    - .DS_Store
